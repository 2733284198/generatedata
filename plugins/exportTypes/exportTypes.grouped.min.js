define(["manager","constants","lang","generator"],function(manager,C,L,generator){var MODULE_ID="export-type-CSV";var LANG=L.exportTypePlugins.CSV;var _loadSettings=function(settings){$("#etCSV_delimiter").val(settings.delimiter);$("#etCSV_lineEndings").val(settings.eol)};var _saveSettings=function(){return{"delimiter":$("#etCSV_delimiter").val(),"eol":$("#etCSV_lineEndings").val()}};var _resetSettings=function(){$("#etCSV_delimiter").val("|");$("#etCSV_lineEndings").val("Windows")};var _validate=
function(){var delimiterField=$("#etCSV_delimiter");var errors=[];if(delimiterField.val()==="")errors.push({els:delimiterField,error:LANG.validation_no_delimiter});return errors};manager.registerExportType(MODULE_ID,{validate:_validate,loadSettings:_loadSettings,saveSettings:_saveSettings,resetSettings:_resetSettings})});
define(["manager","constants","lang","generator"],function(manager,C,L,generator){var MODULE_ID="export-type-Excel";var LANG=L.exportTypePlugins.Excel;manager.registerExportType(MODULE_ID,{})});
define(["manager","constants","lang","generator"],function(manager,C,L,generator){var MODULE_ID="export-type-HTML";var LANG=L.exportTypePlugins.HTML;var _dialog=null;var _codeMirror=null;var _init=function(){$(window).resize(_updateDialogDimensions);$("#etHTMLEditCustomFormat").bind("click",function(){_openEditCustomFormatDialog();return false});$("#etHTMLUseCustomExportFormat").bind("click",function(){if(this.checked){$("#etHTMLEditCustomFormat").removeAttr("disabled");$(".etHTMLDefaultFormats").attr("disabled",
"disabled");$(".etHTMLDefaultFormatLabels").addClass("gdDisabledText")}else{$("#etHTMLEditCustomFormat").attr("disabled","disabled");$(".etHTMLDefaultFormats").removeAttr("disabled");$(".etHTMLDefaultFormatLabels").removeClass("gdDisabledText")}});var subscriptions={};subscriptions[C.EVENT.GENERATE]=_onGenerate;manager.subscribe(MODULE_ID,subscriptions);$("#etHTMLCustomContent .CodeMirror").addClass("CodeMirror_medium");_codeMirror=CodeMirror.fromTextArea($("#etHTMLCustomSmarty")[0],{mode:"xml",lineNumbers:true});
_codeMirror.setValue($("#etHTMLCustomSmarty_Template").html());$("#etHTML_ResetCustomHTML").on("click",_resetCustomHTML)};var _updateDialogDimensions=function(){var dimensions=_getDialogDimensions();$("#etHTMLCustomFormatDialog").dialog("option","width",dimensions.dialogWidth);$("#etHTMLCustomFormatDialog").dialog("option","height",dimensions.dialogHeight)};var _openEditCustomFormatDialog=function(){var dimensions=_getDialogDimensions();$("#etHTMLCustomFormatDialog").dialog({title:LANG.custom_html_format,
modal:true,width:dimensions.dialogWidth,height:dimensions.dialogHeight,open:function(){$("#etHTMLCustomContent .CodeMirror-scroll").css({width:dimensions.contentWidth,height:dimensions.contentHeight});_codeMirror.refresh()},buttons:[{text:L.close,click:function(){$(this).dialog("close")}}]});return false};var _getDialogDimensions=function(){var dialogHeight=$(window).height()/100*90;var dialogWidth=$(window).width()/100*90;var contentHeight=dialogHeight-110;var contentWidth=dialogWidth-370;return{dialogHeight:dialogHeight,
dialogWidth:dialogWidth,contentHeight:contentHeight,contentWidth:contentWidth}};var _onGenerate=function(msg){$("#etHTMLCustomHTMLSource").val(_codeMirror.getValue());if(msg.exportTarget!="inPage"||msg.exportType!="HTML")return;msg.editor.setOption("mode","xml")};var _loadSettings=function(settings){$("input[name=etHTMLExportFormat][value="+settings.dataFormat+"]").attr("checked","checked");if(settings.useCustomExportFormat=="1")$("#etHTMLUseCustomExportFormat").attr("checked","checked");else $("#etHTMLUseCustomExportFormat").removeAttr("checked");
$("#etHTMLCustomSmarty").val(settings.customExportSmartyContent)};var _saveSettings=function(){return{dataFormat:$("input[name=etHTMLExportFormat]:checked").val(),useCustomExportFormat:$("#etHTMLUseCustomExportFormat")[0].checked?1:0,customExportSmartyContent:_codeMirror.getValue()}};var _resetSettings=function(){$("input[name=etHTMLExportFormat][value=table]").attr("checked","checked");$("#etHTMLUseCustomExportFormat").removeAttr("disabled").trigger("click");_codeMirror.setValue($("#etHTMLCustomSmarty_Template").html())};
var _resetCustomHTML=function(){_codeMirror.setValue($("#etHTMLCustomSmarty_Template").html())};manager.registerExportType(MODULE_ID,{init:_init,loadSettings:_loadSettings,saveSettings:_saveSettings,resetSettings:_resetSettings})});
define(["manager","constants","lang","generator"],function(manager,C,L,generator){var MODULE_ID="export-type-JSON";var LANG=L.exportTypePlugins.JSON;var _onGenerate=function(msg){if(msg.exportTarget!="inPage"||msg.exportType!="JSON")return;msg.editor.setOption("mode","javascript");var wrapLines=$("#etJSON_stripWhitespace")[0].checked;msg.editor.setOption("lineWrapping",wrapLines)};var _init=function(){var subscriptions={};subscriptions[C.EVENT.GENERATE]=_onGenerate;manager.subscribe(MODULE_ID,subscriptions)};
var _loadSettings=function(settings){if(settings.stripWhitespace=="1")$("#etJSON_stripWhitespace").attr("checked","checked");else $("#etJSON_stripWhitespace").removeAttr("checked");if(settings.hasOwnProperty("dataStructureFormat"))$("input[name=etJSON_dataStructure][value="+settings.dataStructureFormat+"]").attr("checked","checked")};var _saveSettings=function(){return{stripWhitespace:$("#etJSON_stripWhitespace")[0].checked?1:0,dataStructureFormat:$("#etJSON_dataStructureFormat").val()}};var _resetSettings=
function(){$("#etJSON_stripWhitespace").removeAttr("checked")};manager.registerExportType(MODULE_ID,{init:_init,loadSettings:_loadSettings,saveSettings:_saveSettings,resetSettings:_resetSettings})});
define(["manager","constants","lang","generator"],function(manager,C,L,generator){var MODULE_ID="export-type-ProgrammingLanguage";var LANG=L.exportTypePlugins.ProgrammingLanguage;var _onGenerate=function(msg){if(msg.exportTarget!="inPage"||msg.exportType!="ProgrammingLanguage")return;switch($("#etProgrammingLanguage_language")[0].value){case "JavaScript":msg.editor.setOption("mode","javascript");break;case "Perl":msg.editor.setOption("mode","perl");break;case "PHP":msg.editor.setOption("mode","php");
break;case "Ruby":msg.editor.setOption("mode","ruby");break}};var _init=function(){var subscriptions={};subscriptions[C.EVENT.GENERATE]=_onGenerate;subscriptions[C.EVENT.RESULT_TYPE.CHANGE]=_resultTypeChanged;manager.subscribe(MODULE_ID,subscriptions)};var _loadSettings=function(settings){$("#etProgrammingLanguage_language").val(settings.language)};var _saveSettings=function(){return{language:$("#etProgrammingLanguage_language").val()}};var _resetSettings=function(){$("#etProgrammingLanguage_language").val("JavaScript")};
var _resultTypeChanged=function(msg){if(msg.newExportType=="ProgrammingLanguage")$("#gdColTitleTop,#gdColTitleBottom").html(LANG.row_label)};manager.registerExportType(MODULE_ID,{init:_init,loadSettings:_loadSettings,saveSettings:_saveSettings,resetSettings:_resetSettings})});
define(["manager","generator","constants","lang"],function(manager,generator,C,L){var MODULE_ID="export-type-SQL";var LANG=L.exportTypePlugins.SQL;var _init=function(){var subscriptions={};subscriptions[C.EVENT.RESULT_TYPE.CHANGE]=_resultTypeChanged;subscriptions[C.EVENT.GENERATE]=_onGenerate;manager.subscribe(MODULE_ID,subscriptions)};var _resultTypeChanged=function(msg){if(msg.newExportType=="SQL")$("#gdColTitleTop,#gdColTitleBottom").html(LANG.row_label)};var _onGenerate=function(msg){if(msg.exportTarget!=
"inPage"||msg.exportType!="SQL")return;msg.editor.setOption("mode","mysql")};var _validate=function(rowNums){var errors=[];var errorFields=[];var errorFieldVisibleRowNums=[];var validTableCol=new RegExp("^[a-zA-Z][0-9a-zA-Z_$]*$");for(var i=0;i<rowNums.length;i++){var tableColField=$("#gdTitle_"+rowNums[i]);var tableColFieldVal=tableColField.val();if(tableColFieldVal!==""&&!validTableCol.test(tableColFieldVal)){errorFields.push(tableColField);errorFieldVisibleRowNums.push(generator.getVisibleRowOrderByRowNum(rowNums[i]))}}if(errorFields.length)errors.push({els:errorFields,
error:LANG.validation_invalid_col_name+"<b>"+errorFieldVisibleRowNums.join(", ")+"</b>"});var tableNameField=$("#etSQL_tableName");var tableNameFieldVal=$.trim(tableNameField.val());var validTableName=new RegExp("^[a-zA-Z_][0-9a-zA-Z_$]*$");if(tableNameFieldVal===""||!validTableName.test(tableNameFieldVal))errors.push({els:tableNameField,error:LANG.validation_invalid_table_name});return errors};var _loadSettings=function(settings){$("#etSQL_tableName").val(settings.tableName);$("#etSQL_databaseType").val(settings.databaseType);
if(settings.createTable=="1")$("#etSQL_createTable").attr("checked","checked");else $("#etSQL_createTable").removeAttr("checked");if(settings.dropTable=="1")$("#etSQL_dropTable").attr("checked","checked");else $("#etSQL_dropTable").removeAttr("checked");if(settings.encloseWithBackquotes=="1")$("#etSQL_encloseWithBackquotes").attr("checked","checked");else $("#etSQL_encloseWithBackquotes").removeAttr("checked");$("input[name=etSQL_statementType]:eq("+settings.statementType+")").attr("checked","checked");
$("input[name=etSQL_primaryKey]:eq("+settings.primaryKey+")").attr("checked","checked")};var _saveSettings=function(){return{tableName:$("#etSQL_tableName").val(),databaseType:$("#etSQL_databaseType").val(),createTable:$("#etSQL_createTable").attr("checked")?1:0,dropTable:$("#etSQL_dropTable").attr("checked")?1:0,encloseWithBackquotes:$("#etSQL_encloseWithBackquotes").attr("checked")?1:0,statementType:$("input[name=etSQL_statementType]:checked").val(),primaryKey:$("input[name=etSQL_primaryKey]:checked").val()}};
var _resetSettings=function(){$("#etSQL_tableName").val("myTable");$("#etSQL_databaseType").val("MySQL");$("#etSQL_createTable").attr("checked","checked");$("#etSQL_dropTable").attr("checked","checked");$("#etSQL_encloseWithBackquotes").attr("checked","checked");$("input[name=etSQL_statementType][value=insert]").attr("checked","checked");$("input[name=etSQL_primaryKey][value=default]").attr("checked","checked")};manager.registerExportType(MODULE_ID,{init:_init,validate:_validate,loadSettings:_loadSettings,
saveSettings:_saveSettings,resetSettings:_resetSettings})});
define(["manager","generator","constants","lang"],function(manager,generator,C,L){var MODULE_ID="export-type-XML";var LANG=L.exportTypePlugins.XML;var _codeMirror=null;var _defaultCustomXML='{if $isFirstBatch}\n<?xml version="1.0" encoding="UTF-8" ?>\n'+"<records>\n"+"{/if}\n"+"{foreach $rowData as $row}\n"+"\t<record>\n"+"{foreach from=$colData item=col name=c}\n"+"\t\t<{$col}>{$row[$smarty.foreach.c.index]}</{$col}>\n"+"{/foreach}\n"+"\t</record>\n"+"{/foreach}\n"+"{if $isLastBatch}\n"+"</records>\n"+
"{/if}";var _init=function(){var subscriptions={};subscriptions[C.EVENT.RESULT_TYPE.CHANGE]=_resultTypeChanged;subscriptions[C.EVENT.GENERATE]=_onGenerate;manager.subscribe(MODULE_ID,subscriptions);$(window).resize(_updateDialogDimensions);$("#etXMLEditCustomFormat").bind("click",function(){_openEditCustomFormatDialog();return false});$("#etXMLUseCustomExportFormat").bind("click",function(){if(this.checked){$("#etXMLEditCustomFormat").removeAttr("disabled");$("#etXMLRootNodeName,#etXMLRecordNodeName").attr("disabled",
"disabled");$(".etXMLDefaultFormatLabels").addClass("gdDisabledText")}else{$("#etXMLEditCustomFormat").attr("disabled","disabled");$("#etXMLRootNodeName,#etXMLRecordNodeName").removeAttr("disabled");$(".etXMLDefaultFormatLabels").removeClass("gdDisabledText")}});if($("#etXML_useCustomExportFormat").attr("checked"))$("#etXML_customFormat").removeAttr("disabled").removeClass("gdDisabled");_codeMirror=CodeMirror.fromTextArea($("#etXMLCustomSmarty")[0],{mode:"xml",lineNumbers:true});$("#etXMLCustomContent .CodeMirror").addClass("CodeMirror_medium");
_codeMirror.setValue(_defaultCustomXML);$("#etXML_ResetCustomHTML").on("click",_resetCustomHTML)};var _validate=function(rowNums){var errors=[];var invalidNodeNames=[];for(var i=0;i<rowNums.length;i++){var rowNum=rowNums[i];var nodeName=$("#gdTitle_"+rowNum);var nodeNameVal=nodeName.val();if(nodeNameVal.match(/\W/)||nodeNameVal.match(/^[^a-zA-Z]/))invalidNodeNames.push({field:$("#gdTitle_"+rowNum),visibleRowNum:generator.getVisibleRowOrderByRowNum(rowNum)})}if(invalidNodeNames.length){var problemFields=
[];var rowNumbers=[];for(var j=0;j<invalidNodeNames.length;j++){problemFields.push(invalidNodeNames[j].field);rowNumbers.push(invalidNodeNames[j].visibleRowNum)}errors.push({els:problemFields,error:LANG.invalid_node_names+" <b>"+rowNumbers.join(", ")+"</b>"})}var rootNode=$("#etXMLRootNodeName");var rootNodeValue=$.trim(rootNode.val());var recordNode=$("#etXMLRecordNodeName");var recordNodeValue=$.trim(recordNode.val());if(rootNodeValue==="")errors.push({els:[rootNode],error:LANG.missing_xml_root_node_name});
else if(rootNodeValue.match(/\W/))errors.push({els:[rootNode],error:LANG.invalid_xml_root_node_name});else if(recordNodeValue==="")errors.push({els:[recordNode],error:LANG.missing_xml_record_node_name});else if(recordNodeValue.match(/\W/))errors.push({els:[recordNode],error:LANG.invalid_xml_record_node_name});return errors};var _loadSettings=function(settings){$("#etXMLRootNodeName").val(settings.rootNodeName);$("#etXMLRecordNodeName").val(settings.recordNodeName);if(settings.useCustomExportFormat==
"1")$("#etXMLUseCustomExportFormat").attr("checked","checked");else $("#etXMLUseCustomExportFormat").removeAttr("checked");$("#etXMLUseCustomExportFormat").trigger("click");_codeMirror.setValue(settings.customFormat)};var _saveSettings=function(){return{rootNodeName:$("#etXMLRootNodeName").val(),recordNodeName:$("#etXMLRecordNodeName").val(),useCustomExportFormat:$("#etXMLUseCustomExportFormat").attr("checked")?1:0,customFormat:_codeMirror.getValue()}};var _resetSettings=function(){$("#etXMLRootNodeName").val("records");
$("#etXMLRecordNodeName").val("record");$("#etXMLUseCustomExportFormat").removeAttr("checked").trigger("click");_codeMirror.setValue(_defaultCustomXML)};var _resultTypeChanged=function(msg){if(msg.newExportType=="XML")$("#gdColTitleTop,#gdColTitleBottom").html(LANG.row_label)};var _openEditCustomFormatDialog=function(){var dimensions=_getDialogDimensions();$("#etXMLCustomFormatDialog").dialog({title:"Custom XML Format",modal:true,width:dimensions.dialogWidth,height:dimensions.dialogHeight,open:function(){$("#etXMLCustomContent .CodeMirror-scroll").css({width:dimensions.contentWidth,
height:dimensions.contentHeight});_codeMirror.refresh()},buttons:[{text:"Close",click:function(){$(this).dialog("close")}}]});return false};var _getDialogDimensions=function(){var dialogHeight=$(window).height()/100*90;var dialogWidth=$(window).width()/100*90;var contentHeight=dialogHeight-110;var contentWidth=dialogWidth-370;return{dialogHeight:dialogHeight,dialogWidth:dialogWidth,contentHeight:contentHeight,contentWidth:contentWidth}};var _updateDialogDimensions=function(){var dimensions=_getDialogDimensions();
$("#etHTMLCustomFormatDialog").dialog("option","width",dimensions.dialogWidth);$("#etHTMLCustomFormatDialog").dialog("option","height",dimensions.dialogHeight)};var _resetCustomHTML=function(){_codeMirror.setValue(_defaultCustomXML)};var _onGenerate=function(msg){$("#etXMLCustomHTMLSource").val(_codeMirror.getValue());if(msg.exportTarget!="inPage"||msg.exportType!="XML")return;msg.editor.setOption("mode","xml")};manager.registerExportType(MODULE_ID,{init:_init,validate:_validate,loadSettings:_loadSettings,
saveSettings:_saveSettings,resetSettings:_resetSettings})}); 
